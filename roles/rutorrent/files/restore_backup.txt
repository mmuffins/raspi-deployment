# Download the backup that should be restored

# create restore directory
cd ~
mkdir restore

#unzip files while preserving permissions
#bunzip2 [bz2_name_here]
#sudo tar xpf [tarname_here] -C ~/restore
cd ~/restore

#stop services
sudo systemctl stop apache2
sudo systemctl stop rtorrent

# move old directories
sudo mv /var/www/html /var/www/html_old
sudo mv /home/rtorrent/.rtorrent.rc /home/rtorrent/.rtorrent.rc_old
sudo mv /home/rtorrent/.rtorrent-session /home/rtorrent/.rtorrent-session_old
sudo mv /etc/apache2 /etc/apache2_old

#.retorrent-session contains session files, it's not needed to restore them
#restore settings
sudo mv ~/restore/var/www/html /var/www/html
sudo mv ~/restore/home/rtorrent/.rtorrent.rc /home/rtorrent/.rtorrent.rc
sudo mv ~/restore/home/rtorrent/.rtorrent-session /home/rtorrent/.rtorrent-session
sudo mv ~/restore/etc/apache2 /etc/apache2

#check if all directories are in place

#restart services
sudo systemctl start rtorrent
sudo systemctl start apache2

#reboot
sudo reboot

# once everything is running again
sudo rm -r /var/www/html_old
sudo rm -r /home/rtorrent/.rtorrent.rc_old
sudo rm -r /home/rtorrent/.rtorrent-session_old
sudo rm -r /etc/apache2_old
sudo rm -r ~/restore

